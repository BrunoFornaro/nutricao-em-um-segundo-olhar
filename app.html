<!DOCTYPE html>
<html>

<head>
    <!-- Link com o repositório do projeto no observable: https://observablehq.com/d/ffb89fcb60d326fa -->
    <!-- Nome na aba do navegador -->
    <title>Nutrição em um olhar</title>
    <!-- Logo na aba do navegador (gerada pela IA do Canva) -->
    <link rel="shortcut icon" href="img/logo.png" type="image/x-icon">
    <!-- Import o D3 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- Import o Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Folha de estilos -->
    <link rel="stylesheet" href="style.css">
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
        rel="stylesheet">




    <!-- Importar scripts do Firebase -->
    <script type="module">
        const DEBUG = true;

        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyAhS7zhyXHLNGLpQ9saPZZg8Aol8jWaGPA",
            authDomain: "nutricao-em-um-olhar.firebaseapp.com",
            projectId: "nutricao-em-um-olhar",
            storageBucket: "nutricao-em-um-olhar.appspot.com",
            messagingSenderId: "101019466395",
            appId: "1:101019466395:web:d22a7fda84e635e544243e",
            measurementId: "G-MNX0D151MB"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth();
        const db = getFirestore(app);

        // Dados dos alimentos
        var data = await readCSV("archive/tabela.csv");

        // Dicionário que relaciona o nome do alimento com seu índice
        var food_indexes = {}
        for (var i in data) {
            food_indexes[data[i]["Nome"]] = i;
        }
        var nutritional_columns = [
            "Saturados (g)",
            "Monoinsaturados (g)",
            "Poliinsaturados (g)",
            "Manganês (mg)",
            "Fósforo (mg)",
            "Ferro (mg)",
            "Sódio (mg)",
            "Cobre (mg)",
            "Zinco (mg)",
            "Retinol(µg)",
            "Tiamina (mg)",
            "Riboflavina (mg)",
            "Piridoxina (mg)",
            "Niacina (mg)",
            "Vitamina C (mg)",
            "Umidade (%)",
            "Energia (kcal)",
            "Energia (kJ)",
            "Proteína (g)",
            "Lipídeos (g)",
            "Colesterol (mg)",
            "Carboidrato (g)",
            "Fibra Alimentar (g)",
            "Cinzas (g)",
            "Cálcio (mg)",
            "Magnésio (mg)"
        ];

        // Recupera o usuário atual (salvo no local storage)
        var user_uid = localStorage.getItem('user');
        if (DEBUG) {
            console.log(user_uid);
        }

        // Exibe as mensagens de carregamento iniciais
        var elements = ["mensagem_hoje", "mensagem_refeicoes_hoje"]//, "mensagem_mes"]
        for (var i in elements) {
            messageForUser(document.getElementById(elements[i]), "Carregando dados...", "info", 100);
        }

        const fake_data = false

        if (fake_data) {
            populateWithFakeData();

            function populateWithFakeData() {
                // Gera dados falsos nos ultimos 2 meses
                // Função para gerar um número aleatório entre min e max
                function gerarNumeroDecimalAleatorio(min, max) {
                    return Math.random() * (max - min) + min;
                }

                // Hoje
                var today = new Date();
                var today_str = today.getFullYear() + "-" + (today.getMonth() + 1) + "-" + today.getDate();

                // Data de 2 meses atrás
                var curr_day = today.getDate()
                var curr_month = today.getMonth() - 1
                var curr_year = today.getFullYear()
                if (curr_month < 1) {
                    curr_month += 12
                    curr_year -= 1
                }

                // Itera pelos dias do mês até chegar no dia de hoje
                while (
                    curr_day != today.getDate() ||
                    curr_month != today.getMonth() + 1 ||
                    curr_year != today.getFullYear()
                ) {
                    // Cria a string do dia
                    var month_str = curr_month
                    if (month_str < 10) {
                        month_str = "0" + month_str
                    }
                    var day_str = curr_day
                    if (day_str < 10) {
                        day_str = "0" + day_str
                    }
                    var date_str = curr_year + "-" + month_str + "-" + day_str

                    // Gera os dados aleatórios
                    var foods = ["Arroz tipo 2 cozido", "Feijão preto cozido", "Frango filé à milanesa", "Toucinho frito"]
                    var mins = [140, 35, 60, 8]
                    var maxs = [180, 65, 80, 12]

                    // Adiciona os dados do prato no banco de dados
                    for (var i in foods) {
                        var food = foods[i]
                        var min = mins[i]
                        var max = maxs[i]
                        var quantity = gerarNumeroDecimalAleatorio(min, max) * 4;
                        var docRef = doc(
                            db,
                            user_uid,
                            date_str,
                            "plates",
                            "0",
                            "food",
                            i
                        );
                        setDoc(docRef, {
                            name: food,
                            quantity: quantity
                        })
                            .then(() => {
                                if (DEBUG) {
                                    console.log("Document successfully written!");
                                }
                            })
                            .catch((error) => {
                                console.error("Error writing document: ", error);
                            });
                    }

                    // Incrementa o dia
                    const last_day_of_month = new Date(curr_year, curr_month, 0).getDate()
                    curr_day += 1
                    if (curr_day > last_day_of_month) {
                        curr_day = 1
                        curr_month += 1
                        if (curr_month > 12) {
                            curr_month = 1
                            curr_year += 1
                        }
                    }
                }
            }
        }



        const confirmar_elemente = document.getElementById('confirmar');
        confirmar_elemente.addEventListener('click', confirmar);

        // Ids dos campos em objetivos
        var fieldIds = [
            "weight",
            "last_weight",
            "daily_calories",
            "carbs_percent",
            "lipids_percent",
            "protein_percent",
            "tolerance",
            "num_daily_plates"
        ];

        // Recupera os dados do usuário
        const docRef = doc(db, "user_info", user_uid);
        getDoc(docRef)
            .then((docSnap) => {
                // Recupera os dados do documento (testes)
                if (docSnap.exists()) {
                    if (docSnap.data()["initial"] == false) {
                        fieldIds.forEach(function (fieldId) {
                            // Define o valor do elemento como o valor no banco de dados
                            document.getElementById(fieldId).value = docSnap.data()[fieldId];
                        });
                    }
                } else {
                    console.log("No such document!");
                }
            })
            .catch((error) => {
                console.error("Erro ao recuperar os dados:", error);
            });



        function confirmar() {
            const mensagem_objetivos = document.getElementById('mensagem_objetivos');
            messageForUser(mensagem_objetivos, "Atualizando...", "info", 10);

            // Recupera os dados do usuário
            var data = {};

            fieldIds.forEach(function (fieldId) {
                var value = parseInt(document.getElementById(fieldId).value);
                if (isNaN(value)) {
                    var placeholder = document.getElementById(fieldId).placeholder;
                    data[fieldId] = placeholder;
                } else {
                    data[fieldId] = value;
                }
            });

            // Pega o peso do usuário


            // Cria (ou atualiza) o documento para o usuário no Firestore (atual)
            setDoc(doc(db, "user_info", user_uid), {
                weight: data["weight"],
                last_weight: data["last_weight"],
                daily_calories: data["daily_calories"],
                carbs_percent: data["carbs_percent"],
                lipids_percent: data["lipids_percent"],
                protein_percent: data["protein_percent"],
                tolerance: data["tolerance"],
                num_daily_plates: data["num_daily_plates"],
                initial: 0
            })
                .then(() => {
                    console.log("Documento atualizado com sucesso!");

                    // Exibe a mensagem de sucesso
                    messageForUser(mensagem_objetivos, "Atualizado com sucesso!", "success", 3);
                })
                .catch((error) => {
                    // Ocorreu um erro ao gravar no Firestore
                    console.error("Erro ao criar o documento: ", error);


                    // Exibe a mensagem de falha
                    messageForUser(mensagem_objetivos, "Houve algum problema ao atualizar :(", "danger", 5);
                });

            // Cria (ou atualiza) o documento para o usuário no Firestore (histórico)
            setDoc(doc(db, user_uid, curr_date_formated(), "user_info", "info"), {
                weight: data["weight"],
                last_weight: data["last_weight"],
                daily_calories: data["daily_calories"],
                carbs_percent: data["carbs_percent"],
                lipids_percent: data["lipids_percent"],
                protein_percent: data["protein_percent"],
                tolerance: data["tolerance"],
                num_daily_plates: data["num_daily_plates"],
                initial: 0
            })
                .then(() => {
                    console.log("Documento atualizado com sucesso!");
                })
                .catch((error) => {
                    // Ocorreu um erro ao gravar no Firestore
                    console.error("Erro ao criar o documento: ", error);
                });

        }

        // Botão de confirmar o prato
        const confirmar_prato = document.getElementById('confirmar_prato');

        // Adiciona um evento de clique ao botão de confirmar prato
        confirmar_prato.addEventListener('click', async function () {
            // Exibe a mensagem de prato confirmado
            const mensagemElement = document.getElementById("mensagem_confirmar_prato");
            messageForUser(mensagemElement, "Confirmando prato...", "info", 20);

            // Obtém a quantidade de alimentos no prato
            var qtd_alimentos = document.getElementsByClassName('filtro_textual').length;

            // Função assíncrona para recuperar o número de pratos do dia
            async function getNumberOfPlates() {
                var num_pratos = 0;
                var stop = false;

                while (!stop) {

                    try {
                        var docRef = doc(
                            db,
                            user_uid,
                            curr_date_formated(),
                            "plates",
                            "" + num_pratos,
                            "food",
                            "1"
                        );

                        // Aguardar a conclusão da chamada assíncrona
                        var docSnap = await getDoc(docRef);

                        if (docSnap.exists()) {
                            num_pratos++;
                        } else {
                            stop = true;
                        }
                    } catch (error) {
                        console.error("Erro ao recuperar os dados:", error);
                        stop = true;
                    }
                }

                return num_pratos;
            }

            var num_pratos = 0;
            // Chama a função assíncrona para obter o número de pratos
            await getNumberOfPlates().then(function (n) {
                num_pratos = n;
            });

            // Variável para verificar se um alimento foi selecionado
            var has_food = false;
            // Itera pelos alimentos
            for (var i = 1; i <= qtd_alimentos; i++) {
                // Obtém o nome do alimento
                var nome_alimento = document.getElementById('filtro_textual_' + i).value;
                // Obtém a quantidade do alimento
                var quantidade_alimento = document.getElementById('slider_alimento_' + i).value;

                // Verifica se o nome do alimento não é vazio
                if (nome_alimento) {
                    has_food = true;
                    // Cria (ou atualiza) o documento para o usuário no Firestore (atual)
                    setDoc(doc(db, user_uid, curr_date_formated(), "plates", "" + num_pratos, "food", "" + i), {
                        name: nome_alimento,
                        quantity: quantidade_alimento,
                        // hora no formato hh:mm
                        hour: curr_hour_formated()
                    })
                        .then(() => {
                            console.log("Documento atualizado com sucesso!");
                            getDataToTodayPage();
                            fillPlatesList();
                            // Exibe a mensagem de prato confirmado em um alerta verde flutuante
                            messageForUser(mensagemElement, "Prato confirmado!", "success", 3);
                        }
                        )
                        .catch((error) => {
                            // Ocorreu um erro ao gravar no Firestore
                            console.error("Erro ao criar o documento: ", error);

                            // Exibe a mensagem de erro em um alerta vermelho flutuante
                            messageForUser(mensagemElement, "Houve algum problema ao confirmar o prato :(", "danger", 5);
                        }
                        );
                }
            }

            // Exibe uma mensagem de que nenhum alimento foi adicionado
            if (!has_food) {
                messageForUser(mensagemElement, "Nenhum alimento foi adicionado!", "danger", 5);
            }
        });

        /*
        // Recupera os dados do usuário
        getDoc(docRef)
            .then((docSnap) => {
                // Define os valores dos campos dos dados do usuário
                document.getElementById("m").value = docSnap.data()["weight"];
                document.getElementById("pp").value = docSnap.data()["protein_percent"];
                document.getElementById("pc").value = docSnap.data()["carbs_percent"];
                document.getElementById("pl").value = docSnap.data()["lipids_percent"];
                document.getElementById("tol").value = docSnap.data()["tolerance"];

            })
            .catch((error) => {
                console.error("Erro ao recuperar os dados:", error);
            });
        */

        // Adiciona a função para adicionar mais seletores de alimentos ao botão "mais_alimentos"
        document.getElementById("mais_alimentos").addEventListener("click", add_selector);

        // Adiciona a função para remover seletores de alimentos ao botão "menos_alimentos"
        document.getElementById("menos_alimentos").addEventListener("click", remove_selector);

        // Função para pegar os filhos de um elemento
        function get_children(element) {
            var children = [];
            var child = element.firstChild;
            while (child) {
                if (child.nodeType == 1) {
                    children.push(child);
                }
                child = child.nextSibling;
            }
            return children;
        }

        // Função para adicionar mais seletores de alimentos
        function add_selector() {
            // Cria um novo elemento de seleção de alimentos
            var new_selector = document.createElement("div");
            // Obtém o número de seletores de alimentos já existentes
            var num_selectors = get_children(document.getElementById("alimentos_do_prato")).length;
            var num = num_selectors + 1;
            // Adiciona o id ao novo elemento de seleção de alimentos
            new_selector.id = "seletor_alimentos_" + num;
            new_selector.innerHTML = `
                <!-- Seletor ` + num + ` -->
                <div class="row">
                    <div class="col-md-6">
                        <!-- Dropdown com a lista de alimentos junto do campo de filtro textual -->
                        <input type="search" list="lista_alimentos" id="filtro_textual_` + num + `" 
                        placeholder="Escolha um alimento :)" class="filtro_textual">
                        <datalist id="lista_alimentos"></datalist>
                    </div>
                    <div class="col-md-6">
                        <p id="alimento_` + num + `">
                            <input type="range" id="slider_alimento_` + num + `" value="0" min="0" max="300"
                                oninput="this.nextElementSibling.value = this.value">
                            <input type="text" id="quantidade_alimento_` + num + `" value="0" 
                            oninput="this.previousElementSibling.value = this.value" class="quantidade_alimento">
                            g
                        </p>
                    </div>
                </div>
            `
            // Adiciona o novo elemento de seleção de alimentos ao final da lista de seletores de alimentos
            document.getElementById("alimentos_do_prato").appendChild(new_selector);

            d3.select("#filtro_textual_" + num)
                .on("change",
                    function () {
                        highlight_foods();
                    }
                );
        }

        // Função para remover seletores de alimentos
        function remove_selector() {
            // Obtém o número de seletores de alimentos já existentes
            var num_selectors = get_children(document.getElementById("alimentos_do_prato")).length;
            // Se houver mais de um seletor de alimentos, remove o último
            if (num_selectors > 1) {
                document.getElementById("alimentos_do_prato").removeChild(document.getElementById("seletor_alimentos_" + num_selectors));
            }
        }

        // Seletores de tabs para os chats
        var tabsChats = document.querySelectorAll('.tabs_charts.nav-link');
        tabsChats.forEach(function (tab) {
            tab.addEventListener('click', function (event) {
                event.preventDefault();

                // Obtém o conteúdo alvo (pane) associado à tab
                var target = document.querySelector(this.getAttribute('href'));

                // Remove a classe 'active' de todas as tabs
                var activeTabs = document.querySelectorAll('.tabs_charts.nav-link.active');
                activeTabs.forEach(function (activeTab) {
                    activeTab.classList.remove('active');
                });

                // Remove as classes 'show' e 'active' de todas as panes
                var activePanes = document.querySelectorAll('.tabs_charts.tab-pane.fade.show.active');
                activePanes.forEach(function (activePane) {
                    activePane.classList.remove('show', 'active');
                    activePane.classList.add('not_visible');
                });

                // Adiciona a classe 'active' na tab clicada
                this.classList.add('active');

                // Adiciona as classes 'show' e 'active' na pane correspondente
                target.classList.add('show', 'active');
                target.classList.remove('not_visible');
            });
        });

        // Seletores de tabs para as páginas
        var tabsPages = document.querySelectorAll('.tabs_pages.nav-link');
        tabsPages.forEach(function (tab) {
            tab.addEventListener('click', function (event) {
                event.preventDefault();

                // Obtém o conteúdo alvo (pane) associado à tab
                var target = document.querySelector(this.getAttribute('href'));

                // Remove a classe 'active' de todas as tabs
                var activeTabs = document.querySelectorAll('.tabs_pages.nav-link.active');
                activeTabs.forEach(function (activeTab) {
                    activeTab.classList.remove('active');
                });

                // Remove as classes 'show' e 'active' de todas as panes
                var activePanes = document.querySelectorAll('.tabs_pages.tab-pane.fade.show.active');
                activePanes.forEach(function (activePane) {
                    activePane.classList.remove('show', 'active');
                    activePane.classList.add('not_visible');
                });

                // Adiciona a classe 'active' na tab clicada
                this.classList.add('active');

                // Adiciona as classes 'show' e 'active' na pane correspondente
                target.classList.add('show', 'active');
                target.classList.remove('not_visible');
            });
        });


        // Seletores de tabs para os micro nutrientes
        var tabsPages = document.querySelectorAll('.today_tab.nav-link');
        tabsPages.forEach(function (tab) {
            tab.addEventListener('click', function (event) {
                event.preventDefault();

                // Obtém o conteúdo alvo (pane) associado à tab
                var target = document.querySelector(this.getAttribute('href'));

                // Remove a classe 'active' de todas as tabs
                var activeTabs = document.querySelectorAll('.today_tab.nav-link.active');
                activeTabs.forEach(function (activeTab) {
                    activeTab.classList.remove('active');
                });

                // Remove as classes 'show' e 'active' de todas as panes
                var activePanes = document.querySelectorAll('.today_tab.tab-pane.fade.show.active');
                activePanes.forEach(function (activePane) {
                    activePane.classList.remove('show', 'active');
                    activePane.classList.add('not_visible');
                });

                // Adiciona a classe 'active' na tab clicada
                this.classList.add('active');

                // Adiciona as classes 'show' e 'active' na pane correspondente
                target.classList.add('show', 'active');
                target.classList.remove('not_visible');
            });
        });

        // Preenche a lista de pratos do dia
        // Função assíncrona para recuperar os pratos do dia
        // Função assíncrona para recuperar os pratos do dia
        async function getPlates() {
            var plates = []; // Lista vazia para armazenar os pratos
            var num_pratos = 0;
            var stop = false;

            while (!stop) {

                try {
                    var formated_date = data.toISOString().slice(0, 10);
                    var docRef = doc(db, user_uid, new Date().toISOString().slice(0, 10), "plates", "" + num_pratos, "food", "1");
                    var docSnap = await getDoc(docRef);

                    if (docSnap.exists()) {
                        var plateData = docSnap.data();
                        plates.push(plateData); // Adiciona o prato à lista
                        num_pratos++;
                    } else {
                        stop = true;
                    }
                } catch (error) {
                    console.error("Erro ao recuperar os dados:", error);
                    stop = true;
                }
            }

            return plates; // Retorna a lista de pratos
        }

        // Função para preencher a lista de pratos do dia
        function fillPlatesList(plates) {
            // Exibe a mensagem de carregamento
            const message_element = document.getElementById('mensagem_refeicoes_hoje');
            messageForUser(message_element, 'Carregando...', "info", 100);

            // Chama a função assíncrona para obter todos os pratos
            getAllPlates().then(function (plates) {

                // Exemplo do html gerado
                `
                <div class="plates_container">
                    <div class="row">
                        <div class="col-md-12">
                            <h3>
                                Prato 1 - 07:35
                            </h3>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <p>
                                85g
                            </p>
                        </div>
                        <div class="col-md-10">
                            <p>
                                Arroz integral cozido
                            </p>
                        </div>
                    </div>
                </div>
                `

                function div_title_plate(num_plate, hour) {
                    var div = `
                        <div class="row">
                            <div class="col-md-12">
                                <h3>
                                    Prato `+ (parseInt(num_plate) + 1) + ` - ` + hour + `
                                </h3>
                            </div>
                        </div>`
                    return div;
                }

                function div_food_of_plate(food_name, quantity) {
                    var div = `
                        <div class="row">
                            <div class="col-md-2">
                                <p>
                                    `+ quantity + `g
                                </p>
                            </div>
                            <div class="col-md-10">
                                <p>
                                    `+ food_name + `
                                </p>
                            </div>
                        </div>`
                    return div;
                }



                var html_string = ``;


                // Preenche a lista de pratos com os dados recuperados do firebase
                for (var plateIndex in plates) {
                    // Abre a div do prato
                    html_string += `<div class="plates_container">`;

                    // Obtém o prato atual
                    var plate = plates[plateIndex];

                    // Adiciona o título do prato
                    html_string += div_title_plate(plateIndex, plate.hour);

                    // Adiciona os alimentos do prato
                    for (var foodIndex in plate["food"]) {
                        if (foodIndex !== "hour") {
                            // Obtém o alimento atual
                            var food = plate["food"][foodIndex];
                            // Adiciona o alimento ao prato
                            html_string += div_food_of_plate(food["name"], food["quantity"]);
                        }
                    }

                    // Fecha a div do prato
                    html_string += `</div>`;
                }


                html_string += `</div>`;

                document.getElementById("lista_pratos_do_dia").innerHTML = html_string;

                // Oculta a mensagem de carregamento
                messageForUser(message_element, '', "info", 0);
            });
        }

        // Preenche a lista de pratos do dia
        fillPlatesList();

        async function getAllPlates(date = 0) {
            var plates = {}; // Objeto para armazenar os pratos
            var num_pratos = 0;
            var stop_1 = false;
            var stop_2 = false;

            if (!date) {
                date = curr_date_formated()
            }

            while (!stop_1) {
                var num_food = 1;
                stop_1 = true;
                stop_2 = false;

                while (!stop_2) {
                    if (num_food == 2) {
                        stop_1 = false;
                    }

                    try {
                        var docRef = doc(
                            db,
                            user_uid,
                            date,
                            "plates",
                            "" + num_pratos,
                            "food",
                            num_food.toString()
                        );

                        // Aguardar a conclusão da chamada assíncrona
                        var docSnap = await getDoc(docRef);

                        if (docSnap.exists()) {
                            // Obter dados do prato atual
                            var plateData = docSnap.data();
                            var nomeAlimento = plateData["name"];
                            var quantidade = plateData["quantity"];
                            var hora = plateData["hour"];

                            // Adicionar prato ao objeto de pratos
                            if (!plates[num_pratos]) {
                                plates[num_pratos] = {
                                    hour: hora,
                                };
                                plates[num_pratos]["food"] = {};
                            }

                            plates[num_pratos]["food"][num_food.toString()] = {
                                name: nomeAlimento,
                                quantity: quantidade,
                            };

                            num_food++;
                        } else {
                            stop_2 = true;
                        }
                    } catch (error) {
                        console.error("Erro ao recuperar os dados:", error);
                        stop_2 = true;
                    }
                }
                num_pratos++;
            }

            return plates; // Retornar objeto de pratos
        }

        // Função para pegar todos os pratos do mês
        async function getAllPlatesInMonth(year, month) {
            var plates = {}; // Objeto para armazenar os pratos
            var days_in_month = getDaysInMonth(year, month); // Dias no mês

            if (month < 10) {
                month = "0" + month;
            }

            // Itera pelos dias do mês
            for (var day = 1; day <= days_in_month; day++) {
                if (day < 10) {
                    day = "0" + day;
                }

                // Pega o dia atual
                var date = year + "-" + month + "-" + day;

                // Pega os pratos do dia
                var plates_of_day = await getAllPlates(date);

                // Adiciona os pratos do dia ao objeto de pratos
                plates[date] = plates_of_day;
            }

            // Objeto JavaScript
            var objeto = { nome: "João", idade: 25, cidade: "São Paulo" };

            return plates; // Retornar objeto de pratos
        }

        function curr_date_formated() {
            var data = new Date().toLocaleString("pt-BR", { timeZone: "America/Sao_Paulo" });
            var dia = data.slice(0, 2);
            var mes = data.slice(3, 5);
            var ano = data.slice(6, 10);
            return ano + "-" + mes + "-" + dia;

        }

        function curr_hour_formated() {
            var data = new Date().toLocaleString("pt-BR", { timeZone: "America/Sao_Paulo" });
            return data.slice(12, 17);
        }

        // Adiciona um evento a todos os botões da classe nav-link
        var nav_links = document.getElementsByClassName("nav-link");

        // Itera sobre os elementos da coleção nav_links
        for (var i = 0; i < nav_links.length; i++) {
            // Adiciona o evento de clique a cada elemento
            nav_links[i].addEventListener("click", function () {
                // Obtém a div de id #matrix_tooptip
                var matrix_tooltip = document.getElementById("matrix_tooltip");

                if (matrix_tooltip) {
                    // Fecha a div
                    matrix_tooltip.style.visibility = "hidden";

                    // Fecha o pai da div
                    matrix_tooltip.parentElement.style.visibility = "hidden";
                }
            });
        }

        function getDaysInMonth(year, month) {
            // Cria um objeto Date com o primeiro dia do próximo mês
            var date = new Date(year, month, 1); // Mes: 1 = Janeiro, 2 = Fevereiro, ...

            // Subtrai 1 dia para obter o último dia do mês atual
            date.setDate(date.getDate() - 1);

            // Retorna o número de dias no mês
            return date.getDate();
        }

        $(document).ready(function () {
            // Inicialize o Monthpicker
            $("#monthpicker").datepicker({
                format: "mm/yyyy",
                minViewMode: "months",
                autoclose: true,
                altField: "#dateHidden",
                onClose: function (dateText, inst) {
                    var selectedDate = $(this).datepicker("getDate");
                    var selectedMonth = $.datepicker.formatDate("mm", selectedDate);
                    // Outras ações que você deseja realizar quando o valor do monthpicker for alterado
                }
            }).on("changeDate", function (e) {
                var selectedMonth = e.date.toISOString(); // Obtém o mês selecionado (adiciona +1 porque os meses em JavaScript são baseados em zero) 
                var year = e.date.getFullYear(); // Obtém o ano selecionado
                var month = e.date.getMonth() + 1; // Obtém o mês selecionado (adiciona +1 porque os meses em JavaScript são baseados em zero)

                monthpickerFunction(year, month);
                // Outras ações que você deseja realizar quando o valor do monthpicker for alterado
            });

            // Abrir manualmente o Monthpicker quando o campo de entrada for clicado
            $("#monthpicker").on("click", function () {
                $(this).datepicker("show");
            });
        });

        async function getUserInfo(
            date = 0,
            infos = [
                "weight",
                "last_weight",
                "daily_calories",
                "carbs_percent",
                "lipids_percent",
                "protein_percent",
                "tolerance",
                "num_daily_plates"],
        ) {
            if (date == 0) {
                date = curr_date_formated();
            }
            var data = {};

            try {
                var docRef = doc(db, user_uid, date, "user_info", "info");

                // Aguardar a conclusão da chamada assíncrona
                var docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    // Obter dados do prato atual
                    var user_data = docSnap.data();
                    for (var i = 0; i < infos.length; i++) {
                        data[infos[i]] = user_data[infos[i]];
                    }
                }
            } catch (error) {
                console.error("Erro ao recuperar os dados:", error);
            }

            return data;
        }

        async function getUserInfoOfMonth(
            year,
            month,
            infos = [
                "weight",
                "last_weight",
                "daily_calories",
                "carbs_percent",
                "lipids_percent",
                "protein_percent",
                "tolerance",
                "num_daily_plates"
            ]
        ) {
            var user_uid = localStorage.getItem("user_uid");
            var days_in_month = getDaysInMonth(year, month); // Dias no mês
            var data = {};

            if (month < 10) {
                month = "0" + month;
            }

            // Itera pelos dias do mês
            for (var day = 1; day <= days_in_month; day++) {
                if (day < 10) {
                    day = "0" + day;
                }

                // Pega o dia atual
                var date = year + "-" + month + "-" + day;



                // Pega o peso do dia
                var data_of_day = await getUserInfo(
                    date,
                    infos,
                );

                // Adiciona o peso do dia ao objeto de pesos
                data[date] = data_of_day;
            }

            return data;
        }

        async function getFoodNutritionalInfo(food_name, quantity = 100) {
            // Todas as colunas
            // ["Nome", "Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "id", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]
            // Colunas que serão usadas
            var columns = ["Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]

            // Transforma a quantidade em um inteiro
            quantity = parseInt(quantity);

            // Pega os dados dos alimentos
            /*
            var food_info = {
                ...data.find(function (item) {
                    return item.Nome === food_name;
                })
            };
            */
            var food_info = { ...data[food_indexes[food_name]] };

            // Corrige os valores de acordo com a quantidade
            for (var column_index in columns) {
                var column = columns[column_index];
                food_info[column] = food_info[column] * quantity / 100;
            }

            return food_info;
        }

        async function getNutritionalInfoOfPlate(plate) {
            // Todas as colunas
            // ["Nome", "Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "id", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]
            // Colunas que serão usadas
            var columns = ["Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]

            // Variável que armazenará as informações nutricionais do prato
            var plate_nutritional_info = {};

            // Itera pelos alimentos do prato
            for (var food_index in plate) {
                // Alimento atual
                var food = plate[food_index];

                // Pega as informações nutricionais do alimento
                var food_nutritional_info = await getFoodNutritionalInfo(food["name"], food["quantity"]);

                // Adiciona as informações nutricionais do alimento ao prato
                for (var column_index in columns) {
                    var column = columns[column_index];
                    if (plate_nutritional_info[column] == undefined) {
                        plate_nutritional_info[column] = 0;
                    }
                    plate_nutritional_info[column] += food_nutritional_info[column];
                }
            }

            return plate_nutritional_info;
        }

        async function getNutritionalInfoOfPlates(plates) {
            // Todas as colunas
            // ["Nome", "Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "id", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]
            // Colunas que serão usadas
            var columns = ["Saturados (g)", "Monoinsaturados (g)", "Poliinsaturados (g)", "Manganês (mg)", "Fósforo (mg)", "Ferro (mg)", "Sódio (mg)", "Cobre (mg)", "Zinco (mg)", "Retinol(µg)", "Tiamina (mg)", "Riboflavina (mg)", "Piridoxina (mg)", "Niacina (mg)", "Vitamina C (mg)", "Umidade (%)", "Energia (kcal)", "Energia (kJ)", "Proteína (g)", "Lipídeos (g)", "Colesterol (mg)", "Carboidrato (g)", "Fibra Alimentar (g)", "Cinzas (g)", "Cálcio (mg)", "Magnésio (mg)"]

            var nutritional_info = {};
            // Itera pelos pratos
            for (var plate_index in plates) {
                var plate = plates[plate_index]; // Prato atual

                // Pega as informações nutricionais do prato
                var plate_nutritional_info = await getNutritionalInfoOfPlate(plate["food"]);

                // Adiciona as informações nutricionais do prato
                for (var column_index in columns) {
                    var column = columns[column_index];
                    if (nutritional_info[column] == undefined) {
                        nutritional_info[column] = 0;
                    }
                    nutritional_info[column] += plate_nutritional_info[column];
                }
            }
            return nutritional_info;
        }

        async function getNutritionalInfoOfPlatesInMonth(plates_of_month) {
            // Itera pelos dias
            for (var day_index in plates_of_month) {
                var day = plates_of_month[day_index]; // Dia atual
                if (Object.keys(day).length == 0) { // Se o dia não tiver pratos
                    continue;
                }

                var plates_nutritional_info = await getNutritionalInfoOfPlates(day);

                // Adiciona as informações nutricionais dos pratos
                plates_of_month[day_index] = plates_nutritional_info;
            }
            return plates_of_month;
        }

        async function getWeightOfMonth(year, month) {
            var weight2 = await getUserInfoOfMonth(year, month, ["weight", "last_weight"]);
            var weight = { ...weight2 };

            // último dia do mês
            var last_day = new Date(year, month, 0).getDate();
            // Se estivermos no mês atual, o último dia é o dia atual
            if (year == new Date().getFullYear() && month == new Date().getMonth() + 1) {
                last_day = new Date().getDate();
            }

            // Corrige o mês para o formato MM
            if (month < 10) {
                month = "0" + month;
            }

            // Itera pelos dias na ordem crescente para preencher os dias vazios
            // Último peso registrado
            for (var day = 2; day <= last_day; day++) {
                // Dia anterior
                var prev_day = day - 1;
                if (prev_day < 10) {
                    prev_day = "0" + prev_day;
                }
                // Pega o peso do dia anterior
                prev_day = year + "-" + month + "-" + prev_day;
                // Se o dia anterior não tiver peso registrado
                if (Object.keys(weight[prev_day]).length == 0) {
                    continue;
                }

                // Corrige o dia para o formato DD
                if (day < 10) {
                    day = "0" + day;
                }
                // Pega o peso do dia atual
                var curr_day = year + "-" + month + "-" + day;

                // Se o dia não tiver peso registrado
                if (Object.keys(weight[curr_day]).length == 0) {
                    // Preenche o dia com o último peso registrado
                    weight[curr_day] = {
                        "weight": weight[prev_day]["weight"],
                        "last_weight": weight[prev_day]["weight"]
                    }
                }
            }

            // Itera pelos dias na ordem decrescente para preencher os dias vazios
            for (var day = last_day - 1; day >= 1; day--) {
                // Dia posterior
                var next_day = day + 1;
                if (next_day < 10) {
                    next_day = "0" + next_day;
                }
                // Pega o peso do dia posterior
                next_day = year + "-" + month + "-" + next_day;
                // Se o dia posterior não tiver peso registrado
                if (Object.keys(weight[next_day]).length == 0) {
                    continue;
                }

                // Corrige o dia para o formato DD
                if (day < 10) {
                    day = "0" + day;
                }
                // Pega o peso do dia atual
                var curr_day = year + "-" + month + "-" + day;

                // Se o dia não tiver peso registrado
                if (Object.keys(weight[curr_day]).length == 0 && weight[next_day]["last_weight"] != -1) {
                    // Preenche o dia com o último peso registrado
                    weight[curr_day] = {
                        "weight": weight[next_day]["last_weight"],
                        "last_weight": weight[next_day]["last_weight"]
                    }
                }
            }

            // Se nenhum dia do mês tiver peso registrado
            async function hasWeight(weight) {
                var has_weight = false;
                for (var i in weight) {
                    if (Object.keys(weight[i]).length !== 0) {
                        has_weight = true;
                        break;
                    }
                }
                return has_weight;
            }

            var has_weight = await hasWeight(weight);
            if (!has_weight) {
                // Verifica se a data atual é maior que o ultimo dia do mês
                var today = new Date();
                // Itera pelos dias a partir do dia 1 do mês seguinte até encontrar um dia com peso registrado
                // ou até chegar no dia atual
                var next_year = parseInt(year);
                var next_month = 1 + (parseInt(month) % 12);
                if (next_month == 1) {
                    year++;
                }
                while (
                    next_year < today.getFullYear() ||
                    (next_year == today.getFullYear() && next_month <= today.getMonth() + 1)
                ) {
                    if (next_month < 10) {
                        next_month = "0" + next_month;
                    }
                    var next_last_day = new Date(year, month, 0).getDate();
                    for (var next_day = 1; next_day <= next_last_day; next_day++) {
                        // Corrige o dia para o formato DD
                        if (next_day < 10) {
                            next_day = "0" + next_day;
                        }
                        // Pega o peso do dia posterior
                        next_day = next_year + "-" + next_month + "-" + next_day;
                        var next_weight = await getUserInfo(next_day, ["last_weight"]);
                        // Se o dia posterior não tiver peso registrado
                        if (Object.keys(next_weight).length == 0) {
                            // Se encontrar um dia com peso registrado
                        } else {
                            // Preenche todos os dias do mês com o peso do dia encontrado
                            for (var index in weight) {
                                weight[index] = {
                                    "weight": next_weight["last_weight"],
                                    "last_weight": next_weight["last_weight"]
                                }
                            }
                            return weight;
                        }
                        next_day = parseInt(next_day.slice(8, 10));
                    }

                    // Próximo mês
                    next_month = 1 + (parseInt(next_month) % 12);
                    if (next_month == 1) {
                        next_year++;
                    }
                }

                // Se não encontrar nenhum dia com peso registrado
                // Pega as informações atuais do usuário
                var user_info = await getUserCurrentInfo(["weight"]);
                // Preenche todos os dias do mês com o peso atual do usuário
                for (var index in weight) {
                    weight[index] = {
                        "weight": user_info["weight"],
                        "last_weight": user_info["weight"]
                    }
                }
            }

            return weight;
        }

        // Obtém o ano e o mês atual
        var curr_year = new Date().getFullYear();
        var curr_month = new Date().getMonth() + 1;
        // Preenche o gráfico de peso com os dados do mês atual
        await monthpickerFunction(curr_year, curr_month)

        async function getUserCurrentInfo(
            infos = [
                "weight",
                "last_weight",
                "daily_calories",
                "carbs_percent",
                "lipids_percent",
                "protein_percent",
                "tolerance",
                "num_daily_plates"
            ]
        ) {
            // Variável para os dados do usuário
            var user_info = {};

            // Recupera os dados do usuário
            const docRef = doc(db, "user_info", user_uid);
            await getDoc(docRef)
                .then((docSnap) => {
                    // Recupera os dados do documento (testes)
                    if (docSnap.exists()) {
                        var data = docSnap.data();
                        for (var i = 0; i < infos.length; i++) {
                            user_info[infos[i]] = data[infos[i]];
                        }
                    } else {
                        console.log("No such document!");
                    }
                })
                .catch((error) => {
                    console.error("Erro ao recuperar os dados:", error);
                });

            // Retorna os dados do usuário
            return user_info;
        }

        function messageForUser(element, message, type = "success", duration = 3) {
            // Escreve a mensagem
            element.innerHTML = message;
            // Define a cor da mensagem
            var types = ["success", "danger", "warning", "info"];
            element.classList.add("alert", "alert-" + type);
            for (var i = 0; i < types.length; i++) {
                if (type != types[i]) {
                    element.classList.remove("alert-" + types[i]);
                }
            }

            // Remove a mensagem após o tempo definido
            setTimeout(function () {
                element.innerHTML = "";
                element.classList.remove("alert", "alert-" + type);
            }, duration * 1000);
        }

        // Função do monthpicker
        async function monthpickerFunction(year, month) {
            // Exibe a mensagem de carregamento
            const mensagem_element = document.getElementById("mensagem_data");
            messageForUser(mensagem_element, "Carregando... (isso pode demorar um pouco)", "info", 100);

            // Obtém os pratos do mês
            const plates = await getAllPlatesInMonth(year, month);
            // Obtém as informações nutricionais dos pratos do mês
            const nutritional_info_of_month = await getNutritionalInfoOfPlatesInMonth(plates);
            // Obtém o peso do mês
            const weight = await getWeightOfMonth(year, month);

            var data_to_linechart = {};
            // Itera pelos dias
            for (var day_index in nutritional_info_of_month) {
                var curr_nutritional_info = nutritional_info_of_month[day_index]; // Dia atual
                var curr_weight = weight[day_index]; // Dia atual

                // Adiciona a data
                data_to_linechart[day_index] = {
                    "Data": day_index
                };

                // Se o dia não tiver pratos, preenche os dados nutricionais com -1
                if (Object.keys(curr_nutritional_info).length == 0) {
                    for (var colum_index in nutritional_columns) {
                        const colum = nutritional_columns[colum_index];
                        data_to_linechart[day_index][colum] = -1;
                    }

                    data_to_linechart[day_index]
                    // Se o dia tiver pratos, adiciona a informação nutricional
                } else {
                    for (var colum_index in nutritional_columns) {
                        const colum = nutritional_columns[colum_index];
                        data_to_linechart[day_index][colum] = curr_nutritional_info[colum];
                    }
                }

                if (Object.keys(curr_weight).length == 0) { // Se o dia não tiver registro de peso
                    data_to_linechart[day_index]["Peso"] = -1;
                } else {
                    // Adiciona o peso do dia
                    data_to_linechart[day_index]["Peso"] = curr_weight["weight"]
                }

            }

            // Altera os índeces para 0, 1, 2, ...
            data_to_linechart = Object.values(data_to_linechart);

            // Pega o elemento para os dados do linechart
            var linechart_data = document.getElementById("micronutrientes_data");

            // Insere os dados no elemento como JSON (substitui o conteúdo anterior)
            linechart_data.value = JSON.stringify(data_to_linechart);

            // Dispara o evento change para o elemento
            var event = new Event("change");
            linechart_data.dispatchEvent(event);

            // Esconde a mensagem de carregamento
            messageForUser(mensagem_element, "", "success", 0);

            return data_to_linechart;
        }


        // Função para tra

        // Lê os dados do csv archive/macronutrientes.csv
        async function readCSV(file) {
            // Lê o arquivo csv
            var csv = await fetch(file);

            // Converte o arquivo csv para texto
            var text = await csv.text();

            const lines = text.split('\n');
            const headers = lines[0].split(',');

            const result = [];

            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].split(',');
                const obj = {};

                for (let j = 0; j < headers.length; j++) {
                    obj[headers[j]] = line[j];
                }

                result.push(obj);
            }

            return result;
        }


        async function getDataToTodayPage() {
            //Exibe a mensagem de carregamento
            const mensagem_element = document.getElementById("mensagem_hoje");
            messageForUser(mensagem_element, "Carregando dados...", "info", 60);

            var date = curr_date_formated();
            var plates_of_day = await getAllPlates(date);
            var plates_nutritional_info = await getNutritionalInfoOfPlates(plates_of_day);

            if (Object.keys(plates_nutritional_info).length == 0) {
                for (let index in nutritional_columns) {
                    plates_nutritional_info[nutritional_columns[index]] = 0;
                }
            }

            var minerals_data = [{
                "Cobre (mg)": plates_nutritional_info["Cobre (mg)"],
                "Ferro (mg)": plates_nutritional_info["Ferro (mg)"],
                "Fósforo (mg)": plates_nutritional_info["Fósforo (mg)"],
                "Manganês (mg)": plates_nutritional_info["Manganês (mg)"],
                "Sódio (mg)": plates_nutritional_info["Sódio (mg)"],
                "Zinco (mg)": plates_nutritional_info["Zinco (mg)"]
            }]

            var vitamins_data = [{
                "Tiamina (mg)": plates_nutritional_info["Tiamina (mg)"],
                "Riboflavina (mg)": plates_nutritional_info["Riboflavina (mg)"],
                "Piridoxina (mg)": plates_nutritional_info["Piridoxina (mg)"],
                "Niacina (mg)": plates_nutritional_info["Niacina (mg)"],
                "Vitamina C (mg)": plates_nutritional_info["Vitamina C (mg)"],
                "Retinol(µg)": plates_nutritional_info["Retinol(µg)"],
            }]

            var fat_data = [{
                'Saturados (g)': plates_nutritional_info['Saturados (g)'],
                "Monoinsaturados (g)": plates_nutritional_info["Monoinsaturados (g)"],
                "Poliinsaturados (g)": plates_nutritional_info["Poliinsaturados (g)"],
            }]

            var today_macros = [{
                "Carboidrato (g)": plates_nutritional_info["Carboidrato (g)"],
                "Proteína (g)": plates_nutritional_info["Proteína (g)"],
                "Lipídeos (g)": plates_nutritional_info["Lipídeos (g)"],
            }]

            // Converte os dados para JSON
            minerals_data = JSON.stringify(minerals_data);
            vitamins_data = JSON.stringify(vitamins_data);
            fat_data = JSON.stringify(fat_data);
            today_macros = JSON.stringify(today_macros);

            // Pega os elementos para os dados dos gráficos
            var minerals_data_element = document.getElementById("minerals_data");
            var vitamins_data_element = document.getElementById("vitamins_data");
            var fat_data_element = document.getElementById("fat_data");
            var today_macros_element = document.getElementById("macronutrientes_hoje_data");

            // Insere os dados nos elementos como JSON (substitui o conteúdo anterior)
            minerals_data_element.value = minerals_data;
            vitamins_data_element.value = vitamins_data;
            fat_data_element.value = fat_data;
            today_macros_element.value = today_macros;

            // Dispara o evento change para os elementos
            var event = new Event("change");
            minerals_data_element.dispatchEvent(event);
            vitamins_data_element.dispatchEvent(event);
            fat_data_element.dispatchEvent(event);
            today_macros_element.dispatchEvent(event);

            // Esconde a mensagem de carregamento
            messageForUser(mensagem_element, "", "success", 0);
        }
        getDataToTodayPage();

    </script>

    <!-- Importa o script feito de conexão com o firebase (módulo) -->
    <script src="conect_firebase.js" type="module"></script>
</head>

<!-- Header da página -->
<header>

    <!-- Título da página -->
    <div class="row justify-content-center principal_container">
        <div class="col-md-1">
        </div>
        <div class="col-md-1">
        </div>
        <div class="col-md-1">
            <!-- Logo da página -->
            <img src="img/logo_sem_fundo.png" alt="Logo" class="logo" id="logo">
        </div>
        <div class="col-md-6 justify-content-center align-items-center" style="display:flex;">
            <div class="row justify-content-center align-items-center">
                <!-- Título -->
                <h1 style="margin-bottom: 0px;">NUTRIÇÃO EM UM OLHAR</h1>
            </div>
        </div>
        <div class="col-md-1 center_col">
            <div class="row justify-content-center align-items-center">
                <button type="button" class="btn btn-primary header_button" onclick="window.location.href='app.html'">
                    App
                </button>
            </div>
        </div>
        <div class="col-md-1 center_col">
            <div class="row justify-content-center align-items-center">
                <button type="button" class="btn btn-primary header_button"
                    onclick="window.location.href='tutorial.html'">
                    Tutorial
                </button>
            </div>
        </div>
        <div class="col-md-1 center_col">
            <div class="row justify-content-center align-items-center">
                <button type="button" class="btn btn-primary header_button" onclick="window.location.href='about.html'">
                    Sobre
                </button>
            </div>
        </div>
    </div>
</header>

<body>
    <!-- Dados em json -->
    <textarea id="micronutrientes_data" class="not_visible"></textarea>
    <textarea id="vitamins_data" class="not_visible"></textarea>
    <textarea id="fat_data" class="not_visible"></textarea>
    <textarea id="minerals_data" class="not_visible"></textarea>
    <textarea id="macronutrientes_hoje_data" class="not_visible"></textarea>

    <!-- Tabs das páginas do app principal -->
    <div class="row">
        <div class="col-md-12 ">
            <div class="principal_container">
                <ul class="nav nav-pills">
                    <li class="nav-item">
                        <a class="tabs_pages nav-link active" href="#content_selecao_prato" id="tab_selecao_prato"
                            type="button">Montar Prato</a>
                    </li>
                    <li class="nav-item">
                        <a class="tabs_pages nav-link" href="#content_pratos_do_dia" id="tab_pratos_do_dia"
                            type="button">Dados de Hoje</a>
                    </li>
                    <li class="nav-item">
                        <a class="tabs_pages nav-link" href="#content_peso" id="tab_peso" type="button">Dados do mês</a>
                    </li>
                    <li class="nav-item">
                        <a class="tabs_pages nav-link" href="#content_dados_do_usuario" id="tab_dados_do_usuario"
                            type="button">Meus Dados</a>
                    </li>
                </ul>

            </div>

        </div>
    </div>
    <!-- Conteúdo das tabs princiapis do app -->
    <div class="tab-content">
        <div class="tabs_pages tab-pane fade show active" id="content_selecao_prato" role="tabpanel"
            aria-labelledby="tab_selecao_prato">
            <!-- Aba de seleção do prato -->

            <!-- Área para inserir informações do usuário -->
            <div class="not_visible">
                <div class="principal_container">
                    <h3>Informações do usuário</h3>
                    <div id="observablehq-inserts_cell-27326a73"></div>
                </div>
            </div>


            <!-- Parte só últil no backend -->
            <div id="observablehq-insert_atualize_barchart_cell-27326a73" class="not_visible"></div>

            <!-- Seletor dos alimentos e sliders -->
            <div id="seletor_e_sliders" class="not_visible">
                <!-- Seletor dos alimentos -->
                <div id="observablehq-list_food_cell-27326a73"></div>

                <!-- Sliders para os pesos dos alimentos -->
                <div id="observablehq-sliders_quantity_cell-27326a73"></div>
            </div>


            <div class="row ">
                <!-- Seletores dos alimentos -->
                <div class="col-md-6 fix_height">
                    <div class="principal_container fix_thin_width">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row align-items-center">
                                    <div class="col-md-11">
                                        <h3>
                                            Monte sua refeição:

                                        </h3>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <ul>
                                                    <li>
                                                        <p>
                                                            Selecione os alimentos que compõem sua refeição.
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>Para cada alimento, selecione a quantidade que você
                                                            consumiu (ou vai consumir).</p>
                                                    </li>
                                                    <li>
                                                        <p>
                                                            Utilize os botões + e - para adicionar ou remover alimentos.
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>
                                                            Salve sua refeição clicando no botão "Salvar Prato".
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>
                                                            Veja no "gráfico de prato":
                                                        </p>
                                                        <ul>
                                                            <li>
                                                                <p>
                                                                    A proporção dos alimentos no seu prato;
                                                                </p>
                                                            </li>
                                                            <li>
                                                                <p>
                                                                    Os macronutriente de cada alimento (passe o cursor
                                                                    por cima).
                                                                </p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 buttons_plates">
                                <div class="row justify-content-center">
                                    <div class="col-md-auto">
                                        <button class="btn btn-primary" type="button" id="mais_alimentos">+</button>
                                    </div>
                                    <div class="col-md-auto">
                                        <div id="mensagem_confirmar_prato"></div>
                                        <button class="btn btn-success" type="submit" id="confirmar_prato">Salvar
                                            Prato</button>
                                    </div>
                                    <div class="col-md-auto">
                                        <button class="btn btn-primary" type="button" id="menos_alimentos">-</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Seletor 1 -->
                        <div id="alimentos_do_prato">
                            <!-- Seletor 1 -->
                            <div class="row">
                                <div class="col-md-6">
                                    <!-- Dropdown com a lista de alimentos junto do campo de filtro textual -->
                                    <input type="search" list="lista_alimentos" id="filtro_textual_1"
                                        placeholder="Escolha um alimento :)" class="filtro_textual">
                                    <datalist id="lista_alimentos"></datalist>
                                </div>
                                <div class="col-md-6">
                                    <p id="alimento_1">
                                        <input type="range" id="slider_alimento_1" value="0" min="0" max="300"
                                            oninput="this.nextElementSibling.value = this.value">
                                        <input type="text" id="quantidade_alimento_1" value="0"
                                            oninput="this.previousElementSibling.value = this.value"
                                            class="quantidade_alimento">
                                        g
                                    </p>
                                </div>
                            </div>
                        </div>


                        <!-- Valor energético do prato -->
                        <div id="observablehq-valor_energetico-27326a73"></div>


                        <!-- Gráfico de pizza -->
                        <div class="fix_thin_width">
                            <div class="row justify-content-center">
                                <div id="div_pie_chart"></div>
                            </div>
                        </div>


                    </div>


                </div>
                <!-- Gráficos de filtro e de macronutriente -->
                <div class="col-md-6 fix_height">

                    <!-- Tabs dos gráfico -->
                    <div class="principal_container fix_thin_width">
                        <div class="row">
                            <div class="col-md-11">
                                <h3>Macronutrientes do Prato</h3>
                            </div>
                            <div class="col-md-1">
                                <div class="info-field">
                                    <span class="info-icon">
                                        <i class="bi bi-question-circle"></i>
                                    </span>
                                    <div class="info-content">
                                        <ul>
                                            <li>
                                                <p>
                                                    Utilize o gráfico em "Filtrar alimentos" para:
                                                </p>
                                                <ul>
                                                    <li>
                                                        <p>
                                                            Ver a quantidade de alimentos por macronutriente;
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>
                                                            Filtrar os alimentos que você pode selecionar,
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>
                                                            Selecionar os alimentos que você deseja.
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>
                                                    Utilize o gráfico em "Distribuição dos macronutrientes" para:
                                                </p>
                                                <ul>
                                                    <li>
                                                        <p>
                                                            Ver a quantidade e adequação dos macronutrientes no prato.
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="">
                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a class="tabs_charts nav-link active" href="#content_violin" id="tab_violin"
                                        data-bs-toggle="tab">
                                        <h5>Filtrar alimentos</h5>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="tabs_charts nav-link" href="#content_bar" id="tab_bar"
                                        data-bs-toggle="tab">
                                        <h5>Distribuição dos Macronutrientes</h5>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- Gráficos -->
                        <div id="charts" class="">
                            <div class="tabs_charts tab-pane fade show active" id="content_violin" role="tabpanel"
                                aria-labelledby="tab_violin">
                                <div id="legenda_violinplot"></div>
                                <div id="observablehq-violinplot_cell-27326a73"></div>
                            </div>
                            <div class="tabs_charts tab-pane fade not_visible fix_thin_width" id="content_bar"
                                role="tabpanel" aria-labelledby="tab_bar">
                                <!-- Gráfico de barras -->
                                <div id="observablehq-bar_chart_cell-27326a73"></div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

        </div>

        <!-- Aba de objetivos -->
        <div class="tabs_pages tab-pane fade not_visible" id="content_dados_do_usuario" role="tabpanel"
            aria-labelledby="tab_dados_do_usuario">
            <!-- Aba de objetivos -->
            <!-- Formulário de Inserção de dados -->
            <form>
                <div class="row justify-content-center">
                    <div class="col-md-4 principal_container">
                        <div class="row">
                            <div class="col-md-11">
                                <h3>Seus dados e objetivos</h3>
                            </div>
                            <div class="col-md-1">
                                <div class="info-field">
                                    <span class="info-icon">
                                        <i class="bi bi-question-circle"></i>
                                    </span>
                                    <div class="info-content">
                                        <ul>
                                            <li>
                                                <p>
                                                    Preencha suas informações para serem utilizadas para montar suas
                                                    refeições
                                                    adequadamente.
                                                </p>
                                            </li>
                                            <li>
                                                <p>
                                                    Não coloque as unidades de medidas nos campos, apenas os valores.
                                                </p>
                                            </li>
                                            <li>
                                                <p>
                                                    Separe os decimais com ponto.
                                                </p>
                                            </li>
                                            <li>
                                                <p>
                                                    Após atualizar os campos, clique em "Atualizar dados".
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="weight">Peso (Kg)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Seu peso em Kg.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="weight" placeholder="70.00">
                            </div>

                            <div class="form-group not_visible col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="last_weight">Último Peso (Kg)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Seu ultimo peso registrado (em Kg).
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="last_weight" placeholder="-1">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="daily_calories">Calorias Diárias (Kcal)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Sua meta de consumo de calorias diárias (em Kcal).
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="daily_calories" placeholder="2000">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="carbs_percent">Percentual de Carboidratos (%)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    O percentual das calorias diárias que devem vir de carboidratos.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="carbs_percent" placeholder="50">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="lipids_percent">Percentual de Lipídios (%)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    O percentual das calorias diárias que devem vir de lipídios.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="lipids_percent" placeholder="25">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="protein_percent">Percentual de Proteínas (%)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    O percentual das calorias diárias que devem vir de proteínas.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="protein_percent" placeholder="25">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="tolerance">Tolerância (%)</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    A margem de tolerância (percentual) para o consumo de calorias
                                                    diárias (e, consequentemente, dos macronutrientes).
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="tolerance" placeholder="10">
                            </div>

                            <div class="form-group col-md-12">
                                <div class="row">
                                    <div class="col-md-auto">
                                        <label for="num_daily_plates">Número de refeições por dia</label>
                                    </div>
                                    <div class="col-md-auto">
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Número de refeição diárias.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="num_daily_plates" placeholder="4">
                            </div>

                            <div class="col-md-12">
                                <div class="row justify-content-center">
                                    <div id="mensagem_objetivos"></div>
                                    <div class="col text-center">
                                        <button class="btn btn-primary" type="submit" id="confirmar">Atualizar
                                            dados</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

        </div>


        <!-- Aba de Peso do usuário -->
        <div class="tabs_pages tab-pane fade not_visible" id="content_peso" role="tabpanel" aria-labelledby="tab_peso">
            <!-- Aba de Peso do usuário -->
            <div class="row">
                <!-- Seletor da data -->
                <!-- <div class="col-md-12 ">

                    <!-/- Seletor da data -/->
                <div class="row  principal_container align-items-center">

                </div>
            </div> -->
                <!-- Gráfico de peso -->
                <div class="col-md-12">
                    <!-- Gráfico de peso -->
                    <div class="row principal_container">
                        <div id="mensagem_mes"></div>
                        <div class="col-md-11">
                            <h3>
                                Evolução do mês
                            </h3>
                        </div>
                        <div class="col-md-1">
                            <div class="info-field">
                                <span class="info-icon">
                                    <i class="bi bi-question-circle"></i>
                                </span>
                                <div class="info-content" style="width: 600px; left:-605px;">
                                    <p>
                                        A relação entre a ingestão de macronutrientes e o peso corporal é complexa e
                                        pode
                                        ser influenciada por diversos fatores individuais, como metabolismo, nível de
                                        atividade física e características genéticas. Portanto, a comparação entre os
                                        gráficos de peso e de ingestão de macronutrientes deve ser feita de forma
                                        razoável,
                                        levando em consideração outros fatores e buscando orientação de profissionais de
                                        saúde, como nutricionistas, para interpretação adequada dos dados e definição de
                                        estratégias alimentares personalizadas.
                                    </p>
                                    <p>
                                        Selecione o mês que deseja visualizar e veja como foi seu desempenho ao longo do
                                        mês. O gráfico mostra seu peso (registrado) ao longo do mês, assim como o
                                        consumo de cada macronutriente e a adequação do consumo.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Seletor da data -->
                        <div class="col-md-auto align-items-center">
                            <h4 class="">
                                Selecione a data:
                            </h4>
                        </div>
                        <div class="col-md-3 ">
                            <div id="mensagem_data"></div>
                            <div class="row align-items-center">

                                <!-- Adicione os scripts do Bootstrap e do jQuery -->
                                <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
                            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->



                                <!-- Adicione o CSS do Monthpicker -->
                                <link rel="stylesheet"
                                    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">

                                <!-- Adicione o script do Monthpicker -->
                                <script
                                    src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

                                <!-- <script>
                                $(document).ready(function () {
                                    // Inicialize o Monthpicker
                                    $("#monthpicker").datepicker({
                                        format: "mm/yyyy",
                                        minViewMode: "months",
                                        autoclose: false,
                                        altField: "#dateHidden",
                                        onClose: function(dateText, inst) {
                                            var selectedDate = $(this).datepicker("getDate");
                                            var selectedMonth = $.datepicker.formatDate("mm", selectedDate);
                                            // Outras ações que você deseja realizar quando o valor do monthpicker for alterado
                                        }
                                    }).on("changeDate", function (e) {
                                        var selectedMonth = e.date.toISOString(); // Obtém o mês selecionado (adiciona +1 porque os meses em JavaScript são baseados em zero) 
                                        var year = e.date.getFullYear(); // Obtém o ano selecionado
                                        var month = e.date.getMonth() + 1; // Obtém o mês selecionado (adiciona +1 porque os meses em JavaScript são baseados em zero)
                                        
                                        monthpickerFunction(year, month);
                                        // Outras ações que você deseja realizar quando o valor do monthpicker for alterado
                                    }).datepicker("show")
                                });
                            </script> -->
                                <div class="input-group">
                                    <input type="text" id="monthpicker" class="form-control" placeholder="06/2023">
                                    <div class="input-group-append">
                                        <span class="input-group-text"><i class="bi bi-calendar3"></i></span>
                                    </div>
                                </div>
                                <!-- <style>
                                .datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-top {
                                    left: 470px !important;
                                    top: 625px !important;
                                }
                            </style> -->

                            </div>
                        </div>



                        <div class="col-md-12">
                            <div class="row justify-content-center">
                                <!-- CSS do gráfico -->
                                <div id="observablehq-css_grafico_de_peso-27326a73"></div>
                                <!-- Gráfico -->
                                <div id="observablehq-chart_peso-27326a73" class="not_visible"></div>
                                <div id="linechart_weight"></div>
                                <div id="linechart_carb"></div>
                                <div id="linechart_protein"></div>
                                <div id="linechart_lipid"></div>
                                <div id="linechart_legend"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aba de Refeições do dia -->
        <div class="tabs_pages tab-pane fade not_visible" id="content_pratos_do_dia" role="tabpanel"
            aria-labelledby="tab_pratos_do_dia">
            <div class="row">
                <div class="col-md-6 fix_height">
                    <div class="principal_container fix_thin_width">
                        <div class="row">
                            <div class="col-md-11">
                                <h3>Refeições de hoje</h3>
                            </div>
                            <div class="col-md-1">
                                <div class="info-field">
                                    <span class="info-icon">
                                        <i class="bi bi-question-circle"></i>
                                    </span>
                                    <div class="info-content">
                                        <p>
                                            Veja aqui as refeições que você registrou hoje.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="mensagem_refeicoes_hoje"></div>
                        <div class="lista_pratos_do_dia" id="lista_pratos_do_dia">
                            <!-- Lista de pratos do dia (preenchida por javascript) -->

                            <!-- Teste preenchido a mão -->
                            <!-- <div class="plates_container">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h3>
                                            Prato 1 - 07:35
                                        </h3>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-2">
                                        <p>
                                            85g
                                        </p>
                                    </div>
                                    <div class="col-md-10">
                                        <p>
                                            Arroz integral cozido
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-2">
                                        <p>
                                            120g
                                        </p>
                                    </div>
                                    <div class="col-md-10">
                                        <p>
                                            Feijoada
                                        </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-2">
                                        <p>
                                            100g
                                        </p>
                                    </div>
                                    <div class="col-md-10">
                                        <p>
                                            Frango filé à milanesa
                                        </p>
                                    </div>
                                </div>
                            </div> -->

                        </div>
                    </div>
                </div>
                <!-- Aba dos gráficos dos micronutrientes -->
                <div class="col-md-6 fix_height">
                    <div class="principal_container fix_thin_width">
                        <div class="row">
                            <div class="col-md-11">
                                <h3>Nutrição de Hoje</h3>
                            </div>
                            <div class="col-md-1">
                                <div class="info-field">
                                    <span class="info-icon">
                                        <i class="bi bi-question-circle"></i>
                                    </span>
                                    <div class="info-content">
                                        <h5>
                                            Aqui você pode ver os gráficos:
                                        </h5>
                                        <ul>
                                            <li>
                                                <p>
                                                    Gorduras: mostra a divisão entre gorduras saturadas,
                                                    monoinsaturadas e poliinsaturadas. Nele você pode ver se
                                                    está consumindo em excesso algum tipo de gordura.
                                                </p>
                                            </li>
                                            <li>
                                                <p>
                                                    Minerais: mostra a quantidade dos minerais que você
                                                    consumiu. Nele você pode ver se está consumindo o mínimo
                                                    adequado de cada mineral.
                                                </p>
                                            </li>
                                            <li>
                                                <p>
                                                    Vitaminas: mostra a quantidade das vitaminas que você
                                                    consumiu. Nele você pode ver se está consumindo o mínimo
                                                    adequado de cada vitamina.
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Nav-items para gorduras, minerais e vitaminas -->
                        <ul class="nav nav-tabs today_tab" id="today_tab" role="tablist">
                            <li class="nav-item today_tab" role="presentation" id="tab_gorduras">
                                <a class="nav-link active today_tab" id="gorduras-tab" data-toggle="tab"
                                    href="#content_gorduras" role="tab" aria-controls="content_gorduras"
                                    aria-selected="true">
                                    <h5>Gorduras
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Recomendação da OMS: As gorduras saturadas devem ser consumidas com
                                                    bastante moderação, sem passar de 10% das calorias diárias; gorduras
                                                    poli-insaturadas devem ficar em torno de 6 a 10% das calorias
                                                    diárias e
                                                    as monoinsaturadas com o limite de 20%.
                                                </p>
                                            </div>
                                        </div>
                                    </h5>
                                </a>
                            </li>
                            <li class="nav-item today_tab" role="presentation" id="tab_minerais">
                                <a class="nav-link today_tab" id="minerais-tab" data-toggle="tab"
                                    href="#content_minerais" role="tab" aria-controls="content_minerais"
                                    aria-selected="false">
                                    <h5>Minerais
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    O gráfico apresenta a Ingestão Diária Recomendada para atender às
                                                    necessidades nutricionais da maior parte dos indivíduos e grupos de
                                                    pessoas de uma população sadia. As pessoas que possuem restrição
                                                    alimentar devem seguir a dieta passada pelo médico.
                                                </p>
                                                <p>
                                                    Os valores foram retirados do site da Agência Nacional da Vigilância
                                                    Sanitária (Anvisa).
                                                </p>
                                            </div>
                                        </div>
                                    </h5>
                                </a>
                            </li>
                            <li class="nav-item today_tab" role="presentation" id="tab_vitaminas">
                                <a class="nav-link today_tab" id="vitaminas-tab" data-toggle="tab"
                                    href="#content_vitaminas" role="tab" aria-controls="content_vitaminas"
                                    aria-selected="false">
                                    <h5>Vitaminas
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    O gráfico apresenta a Ingestão Diária Recomendada para atender às
                                                    necessidades nutricionais da maior parte dos indivíduos e grupos de
                                                    pessoas de uma população sadia. As pessoas que possuem restrição
                                                    alimentar devem seguir a dieta passada pelo médico.
                                                </p>
                                                <p>
                                                    Os valores foram retirados do site da Agência Nacional da Vigilância
                                                    Sanitária (Anvisa).
                                                </p>
                                            </div>
                                        </div>
                                    </h5>
                                </a>
                            </li>
                            <li class="nav-item today_tab" role="presentation" id="tab_macronutrientes_hoje">
                                <a class="nav-link today_tab" id="macronutrientes_hoje-tab" data-toggle="tab"
                                    href="#content_macronutrientes_hoje" role="tab" aria-controls="content_macronutrientes_hoje"
                                    aria-selected="false">
                                    <h5>Macronutrientes
                                        <div class="info-field">
                                            <span class="info-icon">
                                                <i class="bi bi-question-circle"></i>
                                            </span>
                                            <div class="info-content">
                                                <p>
                                                    Distribuição dos macronutrientes consumidos no dia de hoje e adequação aos seus objetivos.
                                                </p>
                                            </div>
                                        </div>
                                    </h5>
                                </a>
                            </li>
                        </ul>
                        <!-- Conteúdo das tabs das gorduras, minerais e vitaminas -->
                        <div>

                            <div id="mensagem_hoje"></div>
                            <div class="tab-content" id="myTabContent">
                                <!-- Conteúdo da tab de gorduras -->
                                <div class="tab-pane fade show active today_tab" id="content_gorduras" role="tabpanel"
                                    aria-labelledby="gorduras-tab">
                                    <!-- <div id="observablehq-lipids_cell-27326a73"></div> -->
                                    <div id="legenda_fat_div"></div>
                                    <div id="fat_graph_div"></div>
                                </div>
                                <!-- Conteúdo da tab de minerais -->
                                <div class="tab-pane fade not_visible today_tab" id="content_minerais" role="tabpanel"
                                    aria-labelledby="minerais-tab">
                                    <!-- <div id="observablehq-minerals_cell-27326a73"></div> -->
                                    <div id="legenda_minerals_div"></div>
                                    <div id="minerals_graph_div"></div>
                                </div>
                                <!-- Conteúdo da tab de vitaminas -->
                                <div class="tab-pane fade not_visible today_tab" id="content_vitaminas" role="tabpanel"
                                    aria-labelledby="minerais-tab">
                                    <!-- <div id="observablehq-vitamins_cell-27326a73"></div> -->
                                    <div id="legenda_vitamins_div"></div>
                                    <div id="vitamins_graph_div"></div>
                                </div>
                                <!-- Conteúdo da tab de Macronutrientes do dia -->
                                <div class="tab-pane fade not_visible today_tab" id="content_macronutrientes_hoje" role="tabpanel"
                                    aria-labelledby="minerais-tab">
                                    <!-- <div id="observablehq-vitamins_cell-27326a73"></div> -->
                                    <div id="macronutrientes_hoje_graph_div"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Parte só últil no backend -->
        <div class="not_visible">
            <div id="observablehq-init_bar_chart_cell-27326a73"></div>
            <div id="observablehq-outputs_alimentos-27326a73"></div>
            <div id="observablehq-filter_food_to_bar_chart-27326a73"></div>
            <div id="observablehq-alimentos_selecionados-27326a73"></div>
            <div id="observablehq-filtro_textual-27326a73"></div>
            <div id="observablehq-num_alimento-27326a73"></div>
            <div id="observablehq-botao_confirmar-27326a73"></div>
            <div id="observablehq-function_to_sliders_of_quantity_of_food_cell-27326a73"></div>
            <div id="observablehq-function_to_buttons_of_plus_and_less_selectors-27326a73"></div>
            <div id="observablehq-function_confirm_buttom-27326a73"></div>
            <div id="observablehq-update_dropdown-27326a73"></div>
            <div id="observablehq-update_dropdown_cell-27326a73"></div>
            <div id="observablehq-brush_cell-27326a73"></div>
            <div id="observablehq-violinplot_function_cell-27326a73"></div>
            <div id="observablehq-BarChart-27326a73"></div>
            <div id="observablehq-pallete-27326a73"></div>
            <div id="observablehq-add_on_change_to_textual_filter-27326a73"></div>
            <div id="observablehq-get_selected_foods-27326a73"></div>
            <div id="observablehq-highlight_foods-27326a73"></div>
            <div id="observablehq-highlight_color-27326a73"></div>
            <div id="observablehq-change_linechart-27326a73"></div>
            <div id="observablehq-LineChart3-27326a73"></div>
            <div id="observablehq-macros_faixas-27326a73"></div>
            <div id="observablehq-carboidratoFaixa-27326a73"></div>
            <div id="observablehq-proteinaFaixa-27326a73"></div>
            <div id="observablehq-gorduraFaixa-27326a73"></div>
            <div id="observablehq-LineChartMacros-27326a73"></div>
            <div id="observablehq-legenda-27326a73"></div>
            <div id="observablehq-atualize_micronutrients-27326a73"></div>
            <div id="observablehq-principal_bg_color-27326a73"></div>
            <div id="observablehq-secondary_bg_color-27326a73"></div>
            <div id="observablehq-gera_legenda_violinplot-27326a73"></div>
            <p>Credit: <a href="https://observablehq.com/d/dda5ba56ef8ee385@4504">Projeto Final - Visualização de Dados
                    by
                    Bruno Pereira Fornaro
                    add
                    Vanessa Berwanger Wille</a></p>
        </div>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css">

        <!-- Link com o repositório do projeto no observable: https://observablehq.com/d/ffb89fcb60d326fa -->
        <script type="module">
            import { Runtime, Inspector } from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";
            import define from "https://api.observablehq.com/d/dda5ba56ef8ee385@4504.js?v=3";
            new Runtime().module(define, name => {
                if (name === "inserts_cell") return new Inspector(document.querySelector("#observablehq-inserts_cell-27326a73"));
                if (name === "insert_atualize_barchart_cell") return new Inspector(document.querySelector("#observablehq-insert_atualize_barchart_cell-27326a73"));
                if (name === "list_food_cell") return new Inspector(document.querySelector("#observablehq-list_food_cell-27326a73"));
                if (name === "sliders_quantity_cell") return new Inspector(document.querySelector("#observablehq-sliders_quantity_cell-27326a73"));
                if (name === "violinplot_cell") return new Inspector(document.querySelector("#observablehq-violinplot_cell-27326a73"));
                if (name === "bar_chart_cell") return new Inspector(document.querySelector("#observablehq-bar_chart_cell-27326a73"));
                if (name === "valor_energetico") return new Inspector(document.querySelector("#observablehq-valor_energetico-27326a73"));
                if (name === "init_bar_chart_cell") return new Inspector(document.querySelector("#observablehq-init_bar_chart_cell-27326a73"));
                if (name === "outputs_alimentos") return new Inspector(document.querySelector("#observablehq-outputs_alimentos-27326a73"));
                if (name === "filter_food_to_bar_chart") return new Inspector(document.querySelector("#observablehq-filter_food_to_bar_chart-27326a73"));
                if (name === "alimentos_selecionados") return new Inspector(document.querySelector("#observablehq-alimentos_selecionados-27326a73"));
                if (name === "filtro_textual") return new Inspector(document.querySelector("#observablehq-filtro_textual-27326a73"));
                if (name === "num_alimento") return new Inspector(document.querySelector("#observablehq-num_alimento-27326a73"));
                if (name === "botao_confirmar") return new Inspector(document.querySelector("#observablehq-botao_confirmar-27326a73"));
                if (name === "function_to_sliders_of_quantity_of_food_cell") return new Inspector(document.querySelector("#observablehq-function_to_sliders_of_quantity_of_food_cell-27326a73"));
                if (name === "function_to_buttons_of_plus_and_less_selectors") return new Inspector(document.querySelector("#observablehq-function_to_buttons_of_plus_and_less_selectors-27326a73"));
                if (name === "function_confirm_buttom") return new Inspector(document.querySelector("#observablehq-function_confirm_buttom-27326a73"));
                if (name === "update_dropdown") return new Inspector(document.querySelector("#observablehq-update_dropdown-27326a73"));
                if (name === "update_dropdown_cell") return new Inspector(document.querySelector("#observablehq-update_dropdown_cell-27326a73"));
                if (name === "brush_cell") return new Inspector(document.querySelector("#observablehq-brush_cell-27326a73"));
                if (name === "violinplot_function_cell") return new Inspector(document.querySelector("#observablehq-violinplot_function_cell-27326a73"));
                if (name === "BarChart") return new Inspector(document.querySelector("#observablehq-BarChart-27326a73"));
                if (name === "pallete") return new Inspector(document.querySelector("#observablehq-pallete-27326a73"));
                if (name === "css_grafico_de_peso") return new Inspector(document.querySelector("#observablehq-css_grafico_de_peso-27326a73"));
                if (name === "chart_peso") return new Inspector(document.querySelector("#observablehq-chart_peso-27326a73"));
                //if (name === "div_pie_chart") return new Inspector(document.querySelector("#observablehq-div_pie_chart-27326a73"));
                //if (name === "lipids_cell") return new Inspector(document.querySelector("#observablehq-lipids_cell-27326a73"));
                //if (name === "minerals_cell") return new Inspector(document.querySelector("#observablehq-minerals_cell-27326a73"));
                //if (name === "vitamins_cell") return new Inspector(document.querySelector("#observablehq-vitamins_cell-27326a73"));
                if (name === "add_on_change_to_textual_filter") return new Inspector(document.querySelector("#observablehq-add_on_change_to_textual_filter-27326a73"));
                if (name === "get_selected_foods") return new Inspector(document.querySelector("#observablehq-get_selected_foods-27326a73"));
                if (name === "highlight_foods") return new Inspector(document.querySelector("#observablehq-highlight_foods-27326a73"));
                if (name === "highlight_color") return new Inspector(document.querySelector("#observablehq-highlight_color-27326a73"));
                if (name === "change_linechart") return new Inspector(document.querySelector("#observablehq-change_linechart-27326a73"));
                if (name === "LineChart3") return new Inspector(document.querySelector("#observablehq-LineChart3-27326a73"));
                if (name === "macros_faixas") return new Inspector(document.querySelector("#observablehq-macros_faixas-27326a73"));
                if (name === "carboidratoFaixa") return new Inspector(document.querySelector("#observablehq-carboidratoFaixa-27326a73"));
                if (name === "proteinaFaixa") return new Inspector(document.querySelector("#observablehq-proteinaFaixa-27326a73"));
                if (name === "gorduraFaixa") return new Inspector(document.querySelector("#observablehq-gorduraFaixa-27326a73"));
                if (name === "LineChartMacros") return new Inspector(document.querySelector("#observablehq-LineChartMacros-27326a73"));
                if (name === "legenda") return new Inspector(document.querySelector("#observablehq-legenda-27326a73"));
                if (name === "atualize_micronutrients") return new Inspector(document.querySelector("#observablehq-atualize_micronutrients-27326a73"));
                if (name === "principal_bg_color") return new Inspector(document.querySelector("#observablehq-principal_bg_color-27326a73"));
                if (name === "secondary_bg_color") return new Inspector(document.querySelector("#observablehq-secondary_bg_color-27326a73"));
                if (name === "gera_legenda_violinplot") return new Inspector(document.querySelector("#observablehq-gera_legenda_violinplot-27326a73"));
                return ["chart_peso", "chart_carb", "chart_prot", "chart_lip", "legenda_peso", "add_selector", "violinplot_function_cell", "MatrixChart", "brush_cell"].includes(name);

            });
        </script>
        <!-- Versão -->
        <!-- id: 27326a73 -->
        <!-- commit: 4504 -->
</body>